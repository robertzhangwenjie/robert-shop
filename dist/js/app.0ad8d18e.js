(function(e){function t(t){for(var a,l,i=t[0],n=t[1],c=t[2],d=0,m=[];d<i.length;d++)l=i[d],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&m.push(r[l][0]),r[l]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,c||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],a=!0,i=1;i<s.length;i++){var n=s[i];0!==r[n]&&(a=!1)}a&&(o.splice(t--,1),e=l(l.s=s[0]))}return e}var a={},r={app:0},o=[];function l(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.m=e,l.c=a,l.d=function(e,t,s){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(s,a,function(t){return e[t]}.bind(null,a));return s},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],n=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=n;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0a66":function(e,t,s){"use strict";var a=s("da0d"),r=s.n(a);r.a},"41ef":function(e,t,s){},5530:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a=s("2b0e"),r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},o=[],l={name:"app"},i=l,n=s("2877"),c=Object(n["a"])(i,r,o,!1,null,null,null),u=c.exports,d=(s("99af"),s("2909")),m=s("8c4f"),f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-container"},[s("div",{staticClass:"login-box"},[e._m(0),s("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginFormRules,"label-width":"80px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}}},[s("el-form-item",{attrs:{label:"账号",prop:"username"}},[s("el-input",{directives:[{name:"focus",rawName:"v-focus"}],model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}},[s("i",{staticClass:"iconfont icon-zhanghao1",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[s("i",{staticClass:"iconfont icon-icon_password_yes",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("el-form-item",{staticClass:"login-btn"},[s("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登陆")]),s("el-button",{attrs:{type:"info"},on:{click:e.resetField}},[e._v("重置")])],1)],1)],1)])},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"avatar_box"},[a("img",{attrs:{src:s("cf05"),alt:""}})])}],p={name:"Login",data:function(){return{loginForm:{username:"admin",password:"123456"},loginFormRules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:5,max:18,message:"账号最少5位",trigger:"blur"}],password:[{required:!0,message:"请输入登陆密码",trigger:"blur"},{min:6,max:18,message:"密码在6到18位之间",trigger:"blur"}]}}},methods:{resetField:function(){this.$refs.loginForm.resetFields()},login:function(){var e=this;this.$refs.loginForm.validate((function(t,s){t&&e.$http.post("login",e.loginForm).then((function(t){if(200===t.data.meta.status){var s=t.data.data.token;sessionStorage.setItem("token",s),e.$message.success("登陆成功!"),e.$router.push({name:"home"})}else e.$message({showClose:!0,message:"登陆失败!",type:"error",duration:2e3})})).catch((function(t){console.log(t),e.$message.error("请求超时!")}))}))}}},h=p,b=(s("0a66"),Object(n["a"])(h,f,g,!1,null,"a34c0964",null)),v=b.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",[a("div",{staticClass:"header-left"},[a("img",{attrs:{src:s("cf05"),alt:"系统图标"}}),a("span",[e._v("文杰后台管理系统")])]),a("div",{staticClass:"header-right"},[a("el-button",{attrs:{type:"info"},on:{click:e.logout}},[e._v("退出")])],1)]),a("el-container",[a("el-aside",{attrs:{width:e.isCollapse?"64px":"15%"}},[a("div",{staticClass:"collapse-toggle",domProps:{textContent:e._s(e.isCollapse?"＞":"＜")},on:{click:e.toggleCollapseMenu}}),a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.defaultActive,collapse:e.isCollapse,"background-color":"#303442","text-color":"#fff","unique-opened":"","collapse-transition":!1,router:""}},e._l(e.menuList,(function(t){return a("el-submenu",{key:t.id,attrs:{index:t.id+""}},[a("template",{slot:"title"},[a("i",{class:e.iconsObj[t.id],attrs:{"aria-hidden":"true"}}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.authName))])]),e._l(t.children,(function(t){return a("el-menu-item",{key:t.id,attrs:{index:"/"+t.path},nativeOn:{click:function(s){return e.saveDefaultActive("/"+t.path)}}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.authName))])])],2)}))],2)})),1)],1),a("el-container",[a("el-main",[a("router-view")],1),a("el-footer",[e._v("Footer")])],1)],1)],1)},_=[],F={name:"Home",data:function(){return{menuList:[],iconsObj:{125:"el-icon-user-solid",103:"el-icon-s-tools",101:"el-icon-s-goods",102:"el-icon-s-order",145:"el-icon-s-data"},isCollapse:!1,defaultActive:""}},created:function(){this.getMenuList(),this.defaultActive=sessionStorage.getItem("activePath")},methods:{logout:function(){sessionStorage.clear(),this.$router.push({name:"login"})},getMenuList:function(){var e=this;this.$http.get("menus").then((function(t){200===t.data.meta.status?e.menuList=t.data.data:(e.$message({type:"error",message:"菜单获取失败"}),e.logout())})).catch((function(t){console.log(t),e.$message({type:"error",message:"处理超时",showClose:!0})}))},toggleCollapseMenu:function(){this.isCollapse=!this.isCollapse},saveDefaultActive:function(e){this.defaultActive=e,sessionStorage.setItem("activePath",e)}}},$=F,R=(s("7ca9"),Object(n["a"])($,y,_,!1,null,"375495fa",null)),k=R.exports,w=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},x=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h3",[e._v("Welcome")])])}],C={name:"Welcome"},D=C,U=Object(n["a"])(D,w,x,!1,null,null,null),V=U.exports,L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-container"},[s("div",{staticClass:"breadcrumb"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),s("el-breadcrumb-item",[e._v("用户管理")]),s("el-breadcrumb-item",[e._v("用户列表")])],1)],1),s("div",{staticClass:"user-content"},[s("el-card",{attrs:{shadow:"always"}},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:e.getUserList},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getUserList(t)}},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),s("el-col",{attrs:{span:4}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加用户")])],1)],1)],1),s("el-table",{attrs:{data:e.queryData.users,stripe:""}},[s("el-table-column",{attrs:{label:"#",type:"index"}}),s("el-table-column",{attrs:{label:"姓名",prop:"username"}}),s("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),s("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),s("el-table-column",{attrs:{label:"角色",prop:"role_name"}}),s("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(s){return e.updateUserState(t.row)}},model:{value:t.row.mg_state,callback:function(s){e.$set(t.row,"mg_state",s)},expression:"tableData.row.mg_state"}})]}}])}),s("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(s){return e.showEditUserForm(t.row)}}})],1),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[s("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(s){return e.delUser(t.row.id)}}})],1),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"分配角色",placement:"top",enterable:!1}},[s("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"small"},on:{click:function(s){return e.allocateRole(t.row)}}})],1)]}}])})],1),s("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":e.pageSizes,"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.queryData.total},on:{"size-change":e.handerSizeChange,"current-change":e.handleCurrentChange}})],1),s("el-dialog",{staticClass:"adduser-box",attrs:{title:"添加用户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:function(t){return e.resetFields("userForm")}}},[s("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userFormRules,"label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUser(t)}}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{type:"email"},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),s("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[s("el-input",{attrs:{type:"number"},model:{value:e.userForm.mobile,callback:function(t){e.$set(e.userForm,"mobile",t)},expression:"userForm.mobile"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),s("el-dialog",{staticClass:"adduser-box",attrs:{title:"修改用户信息",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:function(t){return e.resetFields("editUserForm")}}},[s("el-form",{ref:"editUserForm",attrs:{model:e.editUserForm,rules:e.userFormRules,"label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editUser(t)}}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{attrs:{disabled:"disabled"},model:{value:e.editUserForm.username,callback:function(t){e.$set(e.editUserForm,"username",t)},expression:"editUserForm.username"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{attrs:{type:"email"},model:{value:e.editUserForm.email,callback:function(t){e.$set(e.editUserForm,"email",t)},expression:"editUserForm.email"}})],1),s("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[s("el-input",{model:{value:e.editUserForm.mobile,callback:function(t){e.$set(e.editUserForm,"mobile",t)},expression:"editUserForm.mobile"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("确 定")])],1)],1)],1),s("el-dialog",{attrs:{title:"角色分配",visible:e.allocateRoleDialogVisible,width:"50%"},on:{close:e.closeRoleAllocateDialog,"update:visible":function(t){e.allocateRoleDialogVisible=t}}},[s("div",{staticClass:"role-info"},[s("p",[e._v("当前用户: "+e._s(e.userInfo.username))]),s("p",[e._v("当前角色: "+e._s(e.userInfo.role_name))]),s("p",[e._v(" 分配新角色: "),s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedId,callback:function(t){e.selectedId=t},expression:"selectedId"}},e._l(e.roleList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)]),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.allocateRoleDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.updateRole}},[e._v("确 定")])],1)])],1)},O=[];s("498a");function I(e){var t=/^[a-zA-Z0-9]{5,18}$/;return t.test(e)}function q(e){var t=/^1(3|4|5|6|7|8|9)[0-9]\d{8}$/;return t.test(e)}var j={isValidPhone:q,isValidUsername:I},N={name:"Users",data:function(){return{pageSizes:[10,15,20],queryInfo:{query:"",pagenum:1,pagesize:10},queryData:{},addDialogVisible:!1,editDialogVisible:!1,allocateRoleDialogVisible:!1,roleList:[],userInfo:{},selectedId:"",userForm:{username:"",password:"",email:"",mobile:""},editUserForm:{id:"",username:"",email:"",mobile:""},userFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:18,message:"用户名长度为5-18位",trigger:"blur"},{validator:this.validateUsername,trigger:"blur"}],password:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:18,message:"用户名长度在5-18位",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:this.validateMobile,trigger:"blur"}]}}},created:function(){this.getUserList()},methods:{showEditUserForm:function(e){this.editUserForm.username=e.username,this.editUserForm.mobile=e.mobile,this.editUserForm.email=e.email,this.editUserForm.id=e.id,this.editDialogVisible=!0},getRoleList:function(){var e=this;this.$http.get("roles").then((function(t){200===t.data.meta.status?e.roleList=t.data.data:e.$message.error("获取角色列表失败")})).catch((function(t){console.log(t),e.$message.error("网络异常")}))},closeRoleAllocateDialog:function(){this.roleList=[],this.getUserList()},allocateRole:function(e){this.getRoleList(),this.userInfo=e,console.log(this.userInfo),this.allocateRoleDialogVisible=!0},updateRole:function(){var e=this;this.selectedId?(this.$http.put("users/".concat(this.userInfo.id,"/role"),{rid:this.selectedId}).then((function(t){200===t.data.meta.status?e.$message.success("更改角色成功"):e.$message.error("更改角色失败")})).catch((function(t){console.log(t),e.$message.error("网络超时")})),this.allocateRoleDialogVisible=!1):this.$message.warning("请选择变更的角色！")},delUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户，是否继续删除？","提示",{type:"warning"}).then((function(s){console.log(s),t.$http.delete("users/"+e).then((function(e){200===e.data.meta.status?t.$message.success(e.data.meta.msg):t.$message.error(e.data.meta.msg),t.getUserList()}))})).catch((function(e){console.log(e)}))},updateUser:function(){var e=this;this.$refs.editUserForm.validate((function(t,s){t&&(e.editDialogVisible=!1,e.$http.put("users/"+e.editUserForm.id,{email:e.editUserForm.email,mobile:e.editUserForm.mobile}).then((function(t){200===t.data.meta.status?e.$message.success(t.data.meta.msg):e.$message.error(t.data.meta.msg),e.getUserList()})).catch((function(e){console.log(e)})))}))},resetFields:function(e){this.$refs[e].resetFields()},addUser:function(){var e=this;this.$refs.userForm.validate((function(t,s){t&&(e.addDialogVisible=!1,e.$http.post("users",e.userForm).then((function(t){201===t.data.meta.status?(e.$message.success(t.data.meta.msg),e.getUserList()):e.$message.error(t.data.meta.msg)})).catch((function(e){console.log(e)})))}))},validateUsername:function(e,t,s){j.isValidUsername(t)?s():s(new Error("用户名只能为数字和字母"))},validateMobile:function(e,t,s){j.isValidPhone(t)?s():s(new Error("请输入正确的手机号"))},updateUserState:function(e){var t=this;this.$http.put("users/"+e.id+"/state/"+(e.mg_state?"1":"0")).then((function(s){var a=s.data;200===!a.meta.status&&(e.mg_state=!e.mg_state,t.$message.error(a.meta.msg))})).catch((function(t){e.mg_state=!e.mg_state,console.log(t)}))},getUserList:function(){var e=this,t=this.queryInfo.query.trim();this.queryInfo.query=t,this.$http.get("users",{params:this.queryInfo}).then((function(t){var s=t.data;200===s.meta.status?e.queryData=s.data:e.$message.error(s.meta.msg)}))},handerSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()}}},S=N,z=(s("ba40"),Object(n["a"])(S,L,O,!1,null,"e9854818",null)),E=z.exports,P=[{path:"/users",component:E,name:"users"}],A=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"right-container"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),s("el-breadcrumb-item",[e._v("权限管理")]),s("el-breadcrumb-item",[e._v("权限列表")])],1),s("el-card",{staticClass:"box-card"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rightsList,border:""}},[s("el-table-column",{attrs:{label:"#",type:"index"}}),s("el-table-column",{attrs:{label:"权限名称",prop:"authName"}}),s("el-table-column",{attrs:{label:"路径",prop:"path"}}),s("el-table-column",{attrs:{label:"权限等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:e.RightsLevel[t.row.level].type}},[e._v(e._s(e.RightsLevel[t.row.level].name))])]}}])})],1)],1)],1)},M=[],T={0:{name:"一级",type:""},1:{name:"二级",type:"success"},2:{name:"三级",type:"warning"}},K={name:"Rights",data:function(){return{RightsLevel:T,rightsList:[]}},created:function(){this.getRightsList()},methods:{getRightsList:function(){var e=this;this.$http.get("rights/list").then((function(t){200===t.data.meta.status?e.rightsList=t.data.data:e.$message.error(t.data.meta.msg)})).catch((function(e){console.log(e)}))}}},H=K,J=Object(n["a"])(H,A,M,!1,null,null,null),W=J.exports,Z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"roles-container"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),s("el-breadcrumb-item",[e._v("权限管理")]),s("el-breadcrumb-item",[e._v("角色列表")])],1),s("el-card",{staticClass:"box-card"},[s("el-button",{staticClass:"header",attrs:{type:"primary"},on:{click:function(t){e.addRoleDialogVisible=!0}}},[e._v("添加角色")]),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleList,border:"",stripe:""}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,(function(a,r){return s("el-row",{key:a.id,class:["bdbottom","bdleft",0===r?"bdtop":"","center"]},[s("el-col",{attrs:{span:5}},[s("el-tag",[e._v(e._s(a.authName))]),s("i",{staticClass:"el-icon-caret-right"})],1),s("el-col",{attrs:{span:19}},e._l(a.children,(function(a,r){return s("el-row",{key:a.id,class:["bdright","bdleft",0===r?"":"bdtop","center"]},[s("el-col",{attrs:{span:8}},[s("el-tag",{attrs:{type:"success",closable:""},on:{close:function(s){return e.deleteRight(t.row,a.id)}}},[e._v(e._s(a.authName))]),s("i",{staticClass:"el-icon-caret-right"})],1),s("el-col",{attrs:{span:16}},[s("el-row",{staticClass:"bdleft"},[s("el-col",e._l(a.children,(function(a){return s("el-tag",{key:a.id,attrs:{type:"warning",closable:""},on:{close:function(s){return e.deleteRight(t.row,a.id)}}},[e._v(e._s(a.authName))])})),1)],1)],1)],1)})),1)],1)}))}}])}),s("el-table-column",{attrs:{label:"#",type:"index"}}),s("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),s("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc"}}),s("el-table-column",{attrs:{label:"操作",width:"290px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(s){return e.editRole(t.row)}}},[e._v("编辑")]),s("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(s){return e.deleteRole(t.row.id)}}},[e._v("删除")]),s("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(s){return e.assignRights(t.row)}}},[e._v("分配权限")])]}}])})],1)],1),s("el-dialog",{attrs:{title:"添加角色",visible:e.addRoleDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addRoleDialogVisible=t},close:function(t){return e.resetFields("roleForm")}}},[s("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.roleFormRule,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[s("el-input",{model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1),s("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[s("el-input",{model:{value:e.roleForm.roleDesc,callback:function(t){e.$set(e.roleForm,"roleDesc",t)},expression:"roleForm.roleDesc"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.addRoleDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"编辑角色",visible:e.editRoleDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editRoleDialogVisible=t},close:function(t){return e.resetFields("editRoleForm")}}},[s("el-form",{ref:"editRoleForm",attrs:{model:e.editRoleForm,rules:e.roleFormRule,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[s("el-input",{model:{value:e.editRoleForm.roleName,callback:function(t){e.$set(e.editRoleForm,"roleName",t)},expression:"editRoleForm.roleName"}})],1),s("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[s("el-input",{model:{value:e.editRoleForm.roleDesc,callback:function(t){e.$set(e.editRoleForm,"roleDesc",t)},expression:"editRoleForm.roleDesc"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.editRoleDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.updateRole}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{title:"分配权限",visible:e.assignRightsDialogVisible,width:"50%"},on:{"update:visible":function(t){e.assignRightsDialogVisible=t},close:e.initRightsTree}},[s("el-tree",{ref:"rightTree",attrs:{data:e.rightList,"show-checkbox":"","node-key":"id","default-expanded-keys":e.defaultRights,"default-checked-keys":e.defaultRights,props:e.defaultProps},on:{check:e.adjustRights}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.assignRightsDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.updateRights}},[e._v("确 定")])],1)],1)],1)},B=[],G=(s("d3b7"),s("25f0"),s("b85c")),Q={name:"Roles",data:function(){return{roleList:[],addRoleDialogVisible:!1,editRoleDialogVisible:!1,assignRightsDialogVisible:!1,rightList:[],updatedRights:{roleId:"",rids:[]},defaultRights:[],defaultProps:{children:"children",label:"authName"},roleForm:{roleName:"",roleDesc:""},editRoleForm:{id:"",roleName:"",roleDesc:""},roleFormRule:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"},{min:4,max:10,message:"名称在4-10位之间",trigger:"blur"}],roleDesc:[{required:!0,message:"角色描述不能为空",trigger:"blur"}]}}},created:function(){this.getRoles()},methods:{resetFields:function(e){this.$refs[e].resetFields(),this.getRoles()},initRightsTree:function(){this.defaultRights=[],this.updatedRights={roleId:"",rids:[]}},getNodeRights:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e.children)return t.push(e.id);var s,a=Object(G["a"])(e.children);try{for(a.s();!(s=a.n()).done;){var r=s.value;this.getNodeRights(r,t)}}catch(o){a.e(o)}finally{a.f()}return t},assignRights:function(e){var t=this;this.$http.get("rights/tree").then((function(s){200===s.data.meta.status?(t.updatedRights.roleId=e.id,t.rightList=s.data.data,t.getNodeRights(e,t.defaultRights),t.assignRightsDialogVisible=!0):t.$message.error("获取角色列表失败")})).catch((function(e){console.log(e),t.$message.error("网络异常")}))},updateRights:function(){var e=this;this.$http.post("roles/".concat(this.updatedRights.roleId,"/rights"),{rids:this.$refs.rightTree.getCheckedKeys().concat(this.$refs.rightTree.getHalfCheckedKeys()).toString()}).then((function(t){e.assignRightsDialogVisible=!1,200===t.data.meta.status?e.$message.success("分配成功"):e.$message.error("分配失败")})).catch((function(t){console.log(t),e.$message.error("网络异常")}))},adjustRights:function(e,t){this.updatedRights.roleId=e.id,this.updatedRights.rids=t.checkedKeys.concat(t.halfCheckedKeys)},deleteRight:function(e,t){var s=this;this.$confirm("是否删除该角色拥有的权限？","提示",{type:"warning"}).then((function(a){s.$http.delete("roles/"+e.id+"/rights/"+t).then((function(t){200===t.data.meta.status?(e.children=t.data.data,s.$message.success(t.data.meta.msg)):s.$message.error("删除失败")})).catch((function(e){console.log(e),s.$message.err("网络异常")}))}))},editRole:function(e){this.editRoleForm=e,this.editRoleDialogVisible=!0},updateRole:function(){var e=this;this.$refs.editRoleForm.validate((function(t){e.$http.put("roles/"+e.editRoleForm.id,{roleName:e.editRoleForm.roleName,roleDesc:e.editRoleForm.roleDesc}).then((function(t){200===t.data.meta.status?e.$message.success("修改成功"):e.$message.error("修改失败"),e.editRoleDialogVisible=!1})).catch((function(t){console.log(t),e.$message.error("网络异常")}))}))},getRoles:function(){var e=this;this.$http.get("roles").then((function(t){200===t.data.meta.status?e.roleList=t.data.data:e.$message.error(t.data.meta.msg)})).catch((function(e){console.log(e)}))},addRole:function(){var e=this;this.$refs.roleForm.validate((function(t,s){t?e.$http.post("roles",e.roleForm).then((function(t){201===t.data.meta.status?e.$message.success("添加成功"):e.$message.error("添加失败")})).catch((function(t){console.log(t),e.$message.error("网络错误")})):console.log(s)}))},deleteRole:function(e){var t=this;this.$confirm("请确认是否永久删除该角色！","提示",{type:"warning",showClose:!0}).then((function(){t.$http.delete("roles/"+e).then((function(e){200===e.data.meta.status?t.$message.success("删除成功"):t.$message.error("删除失败"),t.getRoles()})).catch((function(e){console.log(e),t.$message.error("网络异常")}))}))}}},X=Q,Y=(s("8c8a"),Object(n["a"])(X,Z,B,!1,null,"6ce47eca",null)),ee=Y.exports,te=[{path:"/rights",component:W},{path:"/roles",component:ee}],se=[{path:"/home",component:k,name:"home",redirect:"/welcome",children:[{path:"/welcome",component:V,name:"welcome"}].concat(Object(d["a"])(P),Object(d["a"])(te))}];a["default"].use(m["a"]);var ae=[{path:"/",redirect:"/home"},{path:"/login",component:v,name:"login"}].concat(Object(d["a"])(se)),re=new m["a"]({routes:ae});re.beforeEach((function(e,t,s){if("/login"===e.path)return s();var a=sessionStorage.getItem("token");if(!a)return s("/login");s()}));var oe=re,le=(s("9e1f"),s("450d"),s("6ed5")),ie=s.n(le),ne=(s("0fb7"),s("f529")),ce=s.n(ne),ue=(s("fe07"),s("6ac5")),de=s.n(ue),me=(s("3c52"),s("0d7b")),fe=s.n(me),ge=(s("b5d8"),s("f494")),pe=s.n(ge),he=(s("960d"),s("defb")),be=s.n(he),ve=(s("8bd8"),s("4cb2")),ye=s.n(ve),_e=(s("4ca3"),s("443e")),Fe=s.n(_e),$e=(s("ce18"),s("f58e")),Re=s.n($e),ke=(s("bdc7"),s("aa2f")),we=s.n(ke),xe=(s("de31"),s("c69e")),Ce=s.n(xe),De=(s("a769"),s("5cc3")),Ue=s.n(De),Ve=(s("adec"),s("3d2d")),Le=s.n(Ve),Oe=(s("a673"),s("7b31")),Ie=s.n(Oe),qe=(s("10cb"),s("f3ad")),je=s.n(qe),Ne=(s("eca7"),s("3787")),Se=s.n(Ne),ze=(s("425f"),s("4105")),Ee=s.n(ze),Pe=(s("1951"),s("eedf")),Ae=s.n(Pe),Me=(s("b84d"),s("c216")),Te=s.n(Me),Ke=(s("8f24"),s("76b9")),He=s.n(Ke),Je=(s("b8e0"),s("a4c4")),We=s.n(Je),Ze=(s("f4f9"),s("c2cc")),Be=s.n(Ze),Ge=(s("7a0f"),s("0f6c")),Qe=s.n(Ge),Xe=(s("5466"),s("ecdf")),Ye=s.n(Xe),et=(s("0c67"),s("299c")),tt=s.n(et),st=(s("e960"),s("b35b")),at=s.n(st),rt=(s("38a0"),s("ad41")),ot=s.n(rt),lt=(s("672e"),s("101e")),it=s.n(lt),nt=(s("cbb5"),s("8bbc")),ct=s.n(nt),ut=(s("5e32"),s("6721")),dt=s.n(ut),mt=(s("a7cc"),s("df33")),ft=s.n(mt),gt=(s("1f1a"),s("4e4b")),pt=s.n(gt),ht=(s("6611"),s("e772")),bt=s.n(ht);a["default"].use(bt.a),a["default"].use(pt.a),a["default"].use(ft.a),a["default"].use(dt.a),a["default"].use(ct.a),a["default"].use(it.a),a["default"].use(ot.a),a["default"].use(at.a),a["default"].use(tt.a),a["default"].use(Ye.a),a["default"].use(Qe.a),a["default"].use(Be.a),a["default"].use(We.a),a["default"].use(He.a),a["default"].use(Te.a),a["default"].use(Ae.a),a["default"].use(Ee.a),a["default"].use(Se.a),a["default"].use(je.a),a["default"].use(Ie.a),a["default"].use(Le.a),a["default"].use(Ue.a),a["default"].use(Ce.a),a["default"].use(we.a),a["default"].use(Re.a),a["default"].use(Fe.a),a["default"].use(ye.a),a["default"].use(be.a),a["default"].use(pe.a),a["default"].use(fe.a),a["default"].use(de.a),a["default"].prototype.$message=ce.a,a["default"].prototype.$confirm=ie.a.confirm,a["default"].directive("focus",{inserted:function(e){e.children[0].focus()}});s("b637"),s("5530"),s("aede");var vt=s("bc3a"),yt=s.n(vt),_t=window.location.host,Ft="http://".concat(_t,"/api/private/v1"),$t=yt.a.create({baseURL:Ft,timeOut:12e3});$t.interceptors.request.use((function(e){if("login"===e.url)return e;var t=sessionStorage.getItem("token");return t?(e.headers.Authorization=t,e):void 0}),(function(e){return console.log(e),Promise.reject(e)}));var Rt=$t;a["default"].prototype.$http=Rt,a["default"].config.productionTip=!1,new a["default"]({router:oe,render:function(e){return e(u)}}).$mount("#app")},"5f48":function(e,t,s){},"7ca9":function(e,t,s){"use strict";var a=s("dc08"),r=s.n(a);r.a},"8c8a":function(e,t,s){"use strict";var a=s("41ef"),r=s.n(a);r.a},aede:function(e,t,s){},b637:function(e,t,s){},ba40:function(e,t,s){"use strict";var a=s("5f48"),r=s.n(a);r.a},cf05:function(e,t,s){e.exports=s.p+"img/logo.06cb521d.png"},da0d:function(e,t,s){},dc08:function(e,t,s){}});
//# sourceMappingURL=app.0ad8d18e.js.map