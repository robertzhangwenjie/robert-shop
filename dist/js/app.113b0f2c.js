(function(e){function t(t){for(var s,l,i=t[0],n=t[1],c=t[2],d=0,m=[];d<i.length;d++)l=i[d],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&m.push(r[l][0]),r[l]=0;for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,i=1;i<a.length;i++){var n=a[i];0!==r[n]&&(s=!1)}s&&(o.splice(t--,1),e=l(l.s=a[0]))}return e}var s={},r={app:0},o=[];function l(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=s,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)l.d(a,s,function(t){return e[t]}.bind(null,s));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],n=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=n;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0a66":function(e,t,a){"use strict";var s=a("da0d"),r=a.n(s);r.a},"41ef":function(e,t,a){},5530:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],l={name:"app"},i=l,n=a("2877"),c=Object(n["a"])(i,r,o,!1,null,null,null),u=c.exports,d=(a("99af"),a("2909")),m=a("8c4f"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-container"},[a("div",{staticClass:"login-box"},[e._m(0),a("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginFormRules,"label-width":"80px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}}},[a("el-form-item",{attrs:{label:"账号",prop:"username"}},[a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}},[a("i",{staticClass:"iconfont icon-zhanghao1",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[a("i",{staticClass:"iconfont icon-icon_password_yes",attrs:{slot:"prefix"},slot:"prefix"})])],1),a("el-form-item",{staticClass:"login-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登陆")]),a("el-button",{attrs:{type:"info"},on:{click:e.resetField}},[e._v("重置")])],1)],1)],1)])},g=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"avatar_box"},[s("img",{attrs:{src:a("cf05"),alt:""}})])}],p={name:"Login",data:function(){return{loginForm:{username:"admin",password:"123456"},loginFormRules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:5,max:18,message:"账号最少5位",trigger:"blur"}],password:[{required:!0,message:"请输入登陆密码",trigger:"blur"},{min:6,max:18,message:"密码在6到18位之间",trigger:"blur"}]}}},methods:{resetField:function(){this.$refs.loginForm.resetFields()},login:function(){var e=this;this.$refs.loginForm.validate((function(t,a){t&&e.$http.post("login",e.loginForm).then((function(t){if(200===t.data.meta.status){var a=t.data.data.token;sessionStorage.setItem("token",a),e.$message.success("登陆成功!"),e.$router.push({name:"home"})}else e.$message({showClose:!0,message:"登陆失败!",type:"error",duration:2e3})})).catch((function(t){console.log(t),e.$message.error("请求超时!")}))}))}}},h=p,b=(a("0a66"),Object(n["a"])(h,f,g,!1,null,"a34c0964",null)),v=b.exports,y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-header",[s("div",{staticClass:"header-left"},[s("img",{attrs:{src:a("cf05"),alt:"系统图标"}}),s("span",[e._v("文杰后台管理系统")])]),s("div",{staticClass:"header-right"},[s("el-button",{attrs:{type:"info"},on:{click:e.logout}},[e._v("退出")])],1)]),s("el-container",[s("el-aside",{attrs:{width:e.isCollapse?"64px":"15%"}},[s("div",{staticClass:"collapse-toggle",domProps:{textContent:e._s(e.isCollapse?"＞":"＜")},on:{click:e.toggleCollapseMenu}}),s("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.defaultActive,collapse:e.isCollapse,"background-color":"#303442","text-color":"#fff","unique-opened":"","collapse-transition":!1,router:""}},e._l(e.menuList,(function(t){return s("el-submenu",{key:t.id,attrs:{index:t.id+""}},[s("template",{slot:"title"},[s("i",{class:e.iconsObj[t.id],attrs:{"aria-hidden":"true"}}),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.authName))])]),e._l(t.children,(function(t){return s("el-menu-item",{key:t.id,attrs:{index:"/"+t.path},nativeOn:{click:function(a){return e.saveDefaultActive("/"+t.path)}}},[s("template",{slot:"title"},[s("i",{staticClass:"el-icon-menu"}),s("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.authName))])])],2)}))],2)})),1)],1),s("el-container",[s("el-main",[s("router-view")],1),s("el-footer",[e._v("Footer")])],1)],1)],1)},_=[],F={name:"Home",data:function(){return{menuList:[],iconsObj:{125:"el-icon-user-solid",103:"el-icon-s-tools",101:"el-icon-s-goods",102:"el-icon-s-order",145:"el-icon-s-data"},isCollapse:!1,defaultActive:""}},created:function(){this.getMenuList(),this.defaultActive=sessionStorage.getItem("activePath")},methods:{logout:function(){sessionStorage.clear(),this.$router.push({name:"login"})},getMenuList:function(){var e=this;this.$http.get("menus").then((function(t){200===t.data.meta.status?e.menuList=t.data.data:(e.$message({type:"error",message:"菜单获取失败"}),e.logout())})).catch((function(t){console.log(t),e.$message({type:"error",message:"处理超时",showClose:!0})}))},toggleCollapseMenu:function(){this.isCollapse=!this.isCollapse},saveDefaultActive:function(e){this.defaultActive=e,sessionStorage.setItem("activePath",e)}}},$=F,R=(a("7ca9"),Object(n["a"])($,y,_,!1,null,"375495fa",null)),k=R.exports,w=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},x=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h3",[e._v("Welcome")])])}],C={name:"Welcome"},D=C,U=Object(n["a"])(D,w,x,!1,null,null,null),V=U.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-container"},[a("div",{staticClass:"breadcrumb"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("用户管理")]),a("el-breadcrumb-item",[e._v("用户列表")])],1)],1),a("div",{staticClass:"user-content"},[a("el-card",{attrs:{shadow:"always"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:e.getUserList},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getUserList(t)}},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加用户")])],1)],1)],1),a("el-table",{attrs:{data:e.queryData.users,stripe:""}},[a("el-table-column",{attrs:{label:"#",type:"index"}}),a("el-table-column",{attrs:{label:"姓名",prop:"username"}}),a("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),a("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),a("el-table-column",{attrs:{label:"角色",prop:"role_name"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(a){return e.updateUserState(t.row)}},model:{value:t.row.mg_state,callback:function(a){e.$set(t.row,"mg_state",a)},expression:"tableData.row.mg_state"}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改",placement:"top",enterable:!1}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(a){return e.showEditUserForm(t.row)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(a){return e.delUser(t.row.id)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"分配角色",placement:"top",enterable:!1}},[a("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"small"},on:{click:function(a){return e.allocateRole(t.row)}}})],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":e.pageSizes,"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.queryData.total},on:{"size-change":e.handerSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{staticClass:"adduser-box",attrs:{title:"添加用户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:function(t){return e.resetFields("userForm")}}},[a("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userFormRules,"label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUser(t)}}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{type:"email"},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{attrs:{type:"number"},model:{value:e.userForm.mobile,callback:function(t){e.$set(e.userForm,"mobile",t)},expression:"userForm.mobile"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"adduser-box",attrs:{title:"修改用户信息",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:function(t){return e.resetFields("editUserForm")}}},[a("el-form",{ref:"editUserForm",attrs:{model:e.editUserForm,rules:e.userFormRules,"label-width":"100px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editUser(t)}}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{disabled:"disabled"},model:{value:e.editUserForm.username,callback:function(t){e.$set(e.editUserForm,"username",t)},expression:"editUserForm.username"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{attrs:{type:"email"},model:{value:e.editUserForm.email,callback:function(t){e.$set(e.editUserForm,"email",t)},expression:"editUserForm.email"}})],1),a("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[a("el-input",{model:{value:e.editUserForm.mobile,callback:function(t){e.$set(e.editUserForm,"mobile",t)},expression:"editUserForm.mobile"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("确 定")])],1)],1)],1),a("el-dialog",{attrs:{title:"角色分配",visible:e.allocateRoleDialogVisible,width:"50%"},on:{close:e.closeRoleAllocateDialog,"update:visible":function(t){e.allocateRoleDialogVisible=t}}},[a("div",{staticClass:"role-info"},[a("p",[e._v("当前用户: "+e._s(e.userInfo.username))]),a("p",[e._v("当前角色: "+e._s(e.userInfo.role_name))]),a("p",[e._v(" 分配新角色: "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedId,callback:function(t){e.selectedId=t},expression:"selectedId"}},e._l(e.roleList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)]),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.allocateRoleDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateRole}},[e._v("确 定")])],1)])],1)},O=[];a("498a");function I(e){var t=/^[a-zA-Z0-9]{5,18}$/;return t.test(e)}function q(e){var t=/^1(3|4|5|6|7|8|9)[0-9]\d{8}$/;return t.test(e)}var j={isValidPhone:q,isValidUsername:I},N={name:"Users",data:function(){return{pageSizes:[10,15,20],queryInfo:{query:"",pagenum:1,pagesize:10},queryData:{},addDialogVisible:!1,editDialogVisible:!1,allocateRoleDialogVisible:!1,roleList:[],userInfo:{},selectedId:"",userForm:{username:"",password:"",email:"",mobile:""},editUserForm:{id:"",username:"",email:"",mobile:""},userFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:18,message:"用户名长度为5-18位",trigger:"blur"},{validator:this.validateUsername,trigger:"blur"}],password:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:18,message:"用户名长度在5-18位",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:this.validateMobile,trigger:"blur"}]}}},created:function(){this.getUserList()},methods:{showEditUserForm:function(e){this.editUserForm.username=e.username,this.editUserForm.mobile=e.mobile,this.editUserForm.email=e.email,this.editUserForm.id=e.id,this.editDialogVisible=!0},getRoleList:function(){var e=this;this.$http.get("roles").then((function(t){200===t.data.meta.status?e.roleList=t.data.data:e.$message.error("获取角色列表失败")})).catch((function(t){console.log(t),e.$message.error("网络异常")}))},closeRoleAllocateDialog:function(){this.roleList=[],this.getUserList()},allocateRole:function(e){this.getRoleList(),this.userInfo=e,console.log(this.userInfo),this.allocateRoleDialogVisible=!0},updateRole:function(){var e=this;this.selectedId?(this.$http.put("users/".concat(this.userInfo.id,"/role"),{rid:this.selectedId}).then((function(t){200===t.data.meta.status?e.$message.success("更改角色成功"):e.$message.error("更改角色失败")})).catch((function(t){console.log(t),e.$message.error("网络超时")})),this.allocateRoleDialogVisible=!1):this.$message.warning("请选择变更的角色！")},delUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户，是否继续删除？","提示",{type:"warning"}).then((function(a){console.log(a),t.$http.delete("users/"+e).then((function(e){200===e.data.meta.status?t.$message.success(e.data.meta.msg):t.$message.error(e.data.meta.msg),t.getUserList()}))})).catch((function(e){console.log(e)}))},updateUser:function(){var e=this;this.$refs.editUserForm.validate((function(t,a){t&&(e.editDialogVisible=!1,e.$http.put("users/"+e.editUserForm.id,{email:e.editUserForm.email,mobile:e.editUserForm.mobile}).then((function(t){200===t.data.meta.status?e.$message.success(t.data.meta.msg):e.$message.error(t.data.meta.msg),e.getUserList()})).catch((function(e){console.log(e)})))}))},resetFields:function(e){this.$refs[e].resetFields()},addUser:function(){var e=this;this.$refs.userForm.validate((function(t,a){t&&(e.addDialogVisible=!1,e.$http.post("users",e.userForm).then((function(t){201===t.data.meta.status?(e.$message.success(t.data.meta.msg),e.getUserList()):e.$message.error(t.data.meta.msg)})).catch((function(e){console.log(e)})))}))},validateUsername:function(e,t,a){j.isValidUsername(t)?a():a(new Error("用户名只能为数字和字母"))},validateMobile:function(e,t,a){j.isValidPhone(t)?a():a(new Error("请输入正确的手机号"))},updateUserState:function(e){var t=this;this.$http.put("users/"+e.id+"/state/"+(e.mg_state?"1":"0")).then((function(a){var s=a.data;200===!s.meta.status&&(e.mg_state=!e.mg_state,t.$message.error(s.meta.msg))})).catch((function(t){e.mg_state=!e.mg_state,console.log(t)}))},getUserList:function(){var e=this,t=this.queryInfo.query.trim();this.queryInfo.query=t,this.$http.get("users",{params:this.queryInfo}).then((function(t){var a=t.data;200===a.meta.status?e.queryData=a.data:e.$message.error(a.meta.msg)}))},handerSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()}}},S=N,z=(a("ba40"),Object(n["a"])(S,L,O,!1,null,"e9854818",null)),E=z.exports,P=[{path:"/users",component:E,name:"users"}],A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right-container"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("权限管理")]),a("el-breadcrumb-item",[e._v("权限列表")])],1),a("el-card",{staticClass:"box-card"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rightsList,border:""}},[a("el-table-column",{attrs:{label:"#",type:"index"}}),a("el-table-column",{attrs:{label:"权限名称",prop:"authName"}}),a("el-table-column",{attrs:{label:"路径",prop:"path"}}),a("el-table-column",{attrs:{label:"权限等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.RightsLevel[t.row.level].type}},[e._v(e._s(e.RightsLevel[t.row.level].name))])]}}])})],1)],1)],1)},M=[],T={0:{name:"一级",type:""},1:{name:"二级",type:"success"},2:{name:"三级",type:"warning"}},K={name:"Rights",data:function(){return{RightsLevel:T,rightsList:[]}},created:function(){this.getRightsList()},methods:{getRightsList:function(){var e=this;this.$http.get("rights/list").then((function(t){200===t.data.meta.status?e.rightsList=t.data.data:e.$message.error(t.data.meta.msg)})).catch((function(e){console.log(e)}))}}},H=K,J=Object(n["a"])(H,A,M,!1,null,null,null),W=J.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"roles-container"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("权限管理")]),a("el-breadcrumb-item",[e._v("角色列表")])],1),a("el-card",{staticClass:"box-card"},[a("el-button",{staticClass:"header",attrs:{type:"primary"},on:{click:function(t){e.addRoleDialogVisible=!0}}},[e._v("添加角色")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,(function(s,r){return a("el-row",{key:s.id,class:["bdbottom","bdleft",0===r?"bdtop":"","center"]},[a("el-col",{attrs:{span:5}},[a("el-tag",[e._v(e._s(s.authName))]),a("i",{staticClass:"el-icon-caret-right"})],1),a("el-col",{attrs:{span:19}},e._l(s.children,(function(s,r){return a("el-row",{key:s.id,class:["bdright","bdleft",0===r?"":"bdtop","center"]},[a("el-col",{attrs:{span:8}},[a("el-tag",{attrs:{type:"success",closable:""},on:{close:function(a){return e.deleteRight(t.row,s.id)}}},[e._v(e._s(s.authName))]),a("i",{staticClass:"el-icon-caret-right"})],1),a("el-col",{attrs:{span:16}},[a("el-row",{staticClass:"bdleft"},[a("el-col",e._l(s.children,(function(s){return a("el-tag",{key:s.id,attrs:{type:"warning",closable:""},on:{close:function(a){return e.deleteRight(t.row,s.id)}}},[e._v(e._s(s.authName))])})),1)],1)],1)],1)})),1)],1)}))}}])}),a("el-table-column",{attrs:{label:"#",type:"index"}}),a("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),a("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc"}}),a("el-table-column",{attrs:{label:"操作",width:"290px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.editRole(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.deleteRole(t.row.id)}}},[e._v("删除")]),a("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(a){return e.assignRights(t.row)}}},[e._v("分配权限")])]}}])})],1)],1),a("el-dialog",{attrs:{title:"添加角色",visible:e.addRoleDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addRoleDialogVisible=t},close:function(t){return e.resetFields("roleForm")}}},[a("el-form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.roleFormRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1),a("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[a("el-input",{model:{value:e.roleForm.roleDesc,callback:function(t){e.$set(e.roleForm,"roleDesc",t)},expression:"roleForm.roleDesc"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addRoleDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑角色",visible:e.editRoleDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editRoleDialogVisible=t},close:function(t){return e.resetFields("editRoleForm")}}},[a("el-form",{ref:"editRoleForm",attrs:{model:e.editRoleForm,rules:e.roleFormRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{model:{value:e.editRoleForm.roleName,callback:function(t){e.$set(e.editRoleForm,"roleName",t)},expression:"editRoleForm.roleName"}})],1),a("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[a("el-input",{model:{value:e.editRoleForm.roleDesc,callback:function(t){e.$set(e.editRoleForm,"roleDesc",t)},expression:"editRoleForm.roleDesc"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editRoleDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateRole}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"分配权限",visible:e.assignRightsDialogVisible,width:"50%"},on:{"update:visible":function(t){e.assignRightsDialogVisible=t},close:e.initRightsTree}},[a("el-tree",{ref:"rightTree",attrs:{data:e.rightList,"show-checkbox":"","node-key":"id","default-expanded-keys":e.defaultRights,"default-checked-keys":e.defaultRights,props:e.defaultProps},on:{check:e.adjustRights}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.assignRightsDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateRights}},[e._v("确 定")])],1)],1)],1)},B=[],G=(a("d3b7"),a("25f0"),a("b85c")),Q={name:"Roles",data:function(){return{roleList:[],addRoleDialogVisible:!1,editRoleDialogVisible:!1,assignRightsDialogVisible:!1,rightList:[],updatedRights:{roleId:"",rids:[]},defaultRights:[],defaultProps:{children:"children",label:"authName"},roleForm:{roleName:"",roleDesc:""},editRoleForm:{id:"",roleName:"",roleDesc:""},roleFormRule:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"},{min:4,max:10,message:"名称在4-10位之间",trigger:"blur"}],roleDesc:[{required:!0,message:"角色描述不能为空",trigger:"blur"}]}}},created:function(){this.getRoles()},methods:{resetFields:function(e){this.$refs[e].resetFields(),this.getRoles()},initRightsTree:function(){this.defaultRights=[],this.updatedRights={roleId:"",rids:[]}},getNodeRights:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e.children)return t.push(e.id);var a,s=Object(G["a"])(e.children);try{for(s.s();!(a=s.n()).done;){var r=a.value;this.getNodeRights(r,t)}}catch(o){s.e(o)}finally{s.f()}return t},assignRights:function(e){var t=this;this.$http.get("rights/tree").then((function(a){200===a.data.meta.status?(t.updatedRights.roleId=e.id,t.rightList=a.data.data,t.getNodeRights(e,t.defaultRights),t.assignRightsDialogVisible=!0):t.$message.error("获取角色列表失败")})).catch((function(e){console.log(e),t.$message.error("网络异常")}))},updateRights:function(){var e=this;this.$http.post("roles/".concat(this.updatedRights.roleId,"/rights"),{rids:this.$refs.rightTree.getCheckedKeys().concat(this.$refs.rightTree.getHalfCheckedKeys()).toString()}).then((function(t){e.assignRightsDialogVisible=!1,200===t.data.meta.status?e.$message.success("分配成功"):e.$message.error("分配失败")})).catch((function(t){console.log(t),e.$message.error("网络异常")}))},adjustRights:function(e,t){this.updatedRights.roleId=e.id,this.updatedRights.rids=t.checkedKeys.concat(t.halfCheckedKeys)},deleteRight:function(e,t){var a=this;this.$confirm("是否删除该角色拥有的权限？","提示",{type:"warning"}).then((function(s){a.$http.delete("roles/"+e.id+"/rights/"+t).then((function(t){200===t.data.meta.status?(e.children=t.data.data,a.$message.success(t.data.meta.msg)):a.$message.error("删除失败")})).catch((function(e){console.log(e),a.$message.err("网络异常")}))}))},editRole:function(e){this.editRoleForm=e,this.editRoleDialogVisible=!0},updateRole:function(){var e=this;this.$refs.editRoleForm.validate((function(t){e.$http.put("roles/"+e.editRoleForm.id,{roleName:e.editRoleForm.roleName,roleDesc:e.editRoleForm.roleDesc}).then((function(t){200===t.data.meta.status?e.$message.success("修改成功"):e.$message.error("修改失败"),e.editRoleDialogVisible=!1})).catch((function(t){console.log(t),e.$message.error("网络异常")}))}))},getRoles:function(){var e=this;this.$http.get("roles").then((function(t){200===t.data.meta.status?e.roleList=t.data.data:e.$message.error(t.data.meta.msg)})).catch((function(e){console.log(e)}))},addRole:function(){var e=this;this.$refs.roleForm.validate((function(t,a){t?e.$http.post("roles",e.roleForm).then((function(t){201===t.data.meta.status?e.$message.success("添加成功"):e.$message.error("添加失败")})).catch((function(t){console.log(t),e.$message.error("网络错误")})):console.log(a)}))},deleteRole:function(e){var t=this;this.$confirm("请确认是否永久删除该角色！","提示",{type:"warning",showClose:!0}).then((function(){t.$http.delete("roles/"+e).then((function(e){200===e.data.meta.status?t.$message.success("删除成功"):t.$message.error("删除失败"),t.getRoles()})).catch((function(e){console.log(e),t.$message.error("网络异常")}))}))}}},X=Q,Y=(a("8c8a"),Object(n["a"])(X,Z,B,!1,null,"6ce47eca",null)),ee=Y.exports,te=[{path:"/rights",component:W},{path:"/roles",component:ee}],ae=[{path:"/home",component:k,name:"home",redirect:"/welcome",children:[{path:"/welcome",component:V,name:"welcome"}].concat(Object(d["a"])(P),Object(d["a"])(te))}];s["default"].use(m["a"]);var se=[{path:"/",redirect:"/home"},{path:"/login",component:v,name:"login"}].concat(Object(d["a"])(ae)),re=new m["a"]({routes:se});re.beforeEach((function(e,t,a){if("/login"===e.path)return a();var s=sessionStorage.getItem("token");if(!s)return a("/login");a()}));var oe=re,le=(a("9e1f"),a("450d"),a("6ed5")),ie=a.n(le),ne=(a("0fb7"),a("f529")),ce=a.n(ne),ue=(a("fe07"),a("6ac5")),de=a.n(ue),me=(a("3c52"),a("0d7b")),fe=a.n(me),ge=(a("b5d8"),a("f494")),pe=a.n(ge),he=(a("960d"),a("defb")),be=a.n(he),ve=(a("8bd8"),a("4cb2")),ye=a.n(ve),_e=(a("4ca3"),a("443e")),Fe=a.n(_e),$e=(a("ce18"),a("f58e")),Re=a.n($e),ke=(a("bdc7"),a("aa2f")),we=a.n(ke),xe=(a("de31"),a("c69e")),Ce=a.n(xe),De=(a("a769"),a("5cc3")),Ue=a.n(De),Ve=(a("adec"),a("3d2d")),Le=a.n(Ve),Oe=(a("a673"),a("7b31")),Ie=a.n(Oe),qe=(a("10cb"),a("f3ad")),je=a.n(qe),Ne=(a("eca7"),a("3787")),Se=a.n(Ne),ze=(a("425f"),a("4105")),Ee=a.n(ze),Pe=(a("1951"),a("eedf")),Ae=a.n(Pe),Me=(a("b84d"),a("c216")),Te=a.n(Me),Ke=(a("8f24"),a("76b9")),He=a.n(Ke),Je=(a("b8e0"),a("a4c4")),We=a.n(Je),Ze=(a("f4f9"),a("c2cc")),Be=a.n(Ze),Ge=(a("7a0f"),a("0f6c")),Qe=a.n(Ge),Xe=(a("5466"),a("ecdf")),Ye=a.n(Xe),et=(a("0c67"),a("299c")),tt=a.n(et),at=(a("e960"),a("b35b")),st=a.n(at),rt=(a("38a0"),a("ad41")),ot=a.n(rt),lt=(a("672e"),a("101e")),it=a.n(lt),nt=(a("cbb5"),a("8bbc")),ct=a.n(nt),ut=(a("5e32"),a("6721")),dt=a.n(ut),mt=(a("a7cc"),a("df33")),ft=a.n(mt),gt=(a("1f1a"),a("4e4b")),pt=a.n(gt),ht=(a("6611"),a("e772")),bt=a.n(ht);s["default"].use(bt.a),s["default"].use(pt.a),s["default"].use(ft.a),s["default"].use(dt.a),s["default"].use(ct.a),s["default"].use(it.a),s["default"].use(ot.a),s["default"].use(st.a),s["default"].use(tt.a),s["default"].use(Ye.a),s["default"].use(Qe.a),s["default"].use(Be.a),s["default"].use(We.a),s["default"].use(He.a),s["default"].use(Te.a),s["default"].use(Ae.a),s["default"].use(Ee.a),s["default"].use(Se.a),s["default"].use(je.a),s["default"].use(Ie.a),s["default"].use(Le.a),s["default"].use(Ue.a),s["default"].use(Ce.a),s["default"].use(we.a),s["default"].use(Re.a),s["default"].use(Fe.a),s["default"].use(ye.a),s["default"].use(be.a),s["default"].use(pe.a),s["default"].use(fe.a),s["default"].use(de.a),s["default"].prototype.$message=ce.a,s["default"].prototype.$confirm=ie.a.confirm,s["default"].directive("focus",{inserted:function(e){e.children[0].focus()}});a("b637"),a("5530"),a("aede");var vt=a("bc3a"),yt=a.n(vt),_t=window.location.hostname,Ft="80",$t="http://".concat(_t,":").concat(Ft,"/api/private/v1"),Rt=yt.a.create({baseURL:$t,timeOut:12e3});Rt.interceptors.request.use((function(e){if("login"===e.url)return e;var t=sessionStorage.getItem("token");return t?(e.headers.Authorization=t,e):void 0}),(function(e){return console.log(e),Promise.reject(e)}));var kt=Rt;s["default"].prototype.$http=kt,s["default"].config.productionTip=!1,new s["default"]({router:oe,render:function(e){return e(u)}}).$mount("#app")},"5f48":function(e,t,a){},"7ca9":function(e,t,a){"use strict";var s=a("dc08"),r=a.n(s);r.a},"8c8a":function(e,t,a){"use strict";var s=a("41ef"),r=a.n(s);r.a},aede:function(e,t,a){},b637:function(e,t,a){},ba40:function(e,t,a){"use strict";var s=a("5f48"),r=a.n(s);r.a},cf05:function(e,t,a){e.exports=a.p+"img/logo.06cb521d.png"},da0d:function(e,t,a){},dc08:function(e,t,a){}});
//# sourceMappingURL=app.113b0f2c.js.map